{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$(),\n  _s5 = $RefreshSig$(),\n  _s6 = $RefreshSig$(),\n  _s7 = $RefreshSig$();\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { apiService } from '../services/api';\n// Query keys for React Query\nexport const queryKeys = {\n  slots: ['slots'],\n  bookings: ['bookings'],\n  booking: id => ['booking', id]\n};\n\n// Hook to get available slots\nexport const useAvailableSlots = (date, providerId, limit = 6, offset = 0) => {\n  _s();\n  return useQuery({\n    queryKey: [...queryKeys.slots, date, providerId, limit, offset],\n    queryFn: () => apiService.getAvailableSlots({\n      date,\n      providerId,\n      limit,\n      offset\n    }),\n    staleTime: 5 * 60 * 1000,\n    // 5 minutes\n    gcTime: 10 * 60 * 1000,\n    // 10 minutes\n    refetchInterval: 3000 // Poll every 3 seconds for real-time updates\n  });\n};\n\n// Hook to get a specific booking\n_s(useAvailableSlots, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useBooking = id => {\n  _s2();\n  return useQuery({\n    queryKey: queryKeys.booking(id),\n    queryFn: () => apiService.getBooking(id),\n    enabled: !!id,\n    staleTime: 2 * 60 * 1000 // 2 minutes\n  });\n};\n\n// Hook to get all providers\n_s2(useBooking, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useProviders = () => {\n  _s3();\n  return useQuery({\n    queryKey: ['providers'],\n    queryFn: () => apiService.getProviders(),\n    staleTime: 10 * 60 * 1000 // 10 minutes\n  });\n};\n\n// Hook to get all slots (including booked/unavailable) for a provider and date\n_s3(useProviders, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useAllSlotsForProviderAndDate = (date, providerId, enabled) => {\n  _s4();\n  return useQuery({\n    queryKey: ['all-slots', date, providerId],\n    queryFn: () => apiService.getAllSlotsForProviderAndDate(date, providerId),\n    enabled,\n    staleTime: 5 * 60 * 1000,\n    refetchInterval: 3000\n  });\n};\n\n// Hook to create a booking\n_s4(useAllSlotsForProviderAndDate, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useCreateBooking = () => {\n  _s5();\n  const queryClient = useQueryClient();\n  return useMutation({\n    mutationFn: bookingData => apiService.createBooking(bookingData),\n    onSuccess: () => {\n      // Invalidate slots query to refresh available slots\n      queryClient.invalidateQueries({\n        queryKey: queryKeys.slots\n      });\n    },\n    onError: error => {\n      console.error('Failed to create booking:', error);\n    }\n  });\n};\n\n// Hook to update booking status\n_s5(useCreateBooking, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n  return [useQueryClient, useMutation];\n});\nexport const useUpdateBooking = () => {\n  _s6();\n  const queryClient = useQueryClient();\n  return useMutation({\n    mutationFn: ({\n      id,\n      status\n    }) => apiService.updateBooking(id, {\n      status\n    }),\n    onSuccess: updatedBooking => {\n      // Update the specific booking in cache\n      queryClient.setQueryData(queryKeys.booking(updatedBooking.id), updatedBooking);\n      // Invalidate slots query to refresh availability\n      queryClient.invalidateQueries({\n        queryKey: queryKeys.slots\n      });\n    },\n    onError: error => {\n      console.error('Failed to update booking:', error);\n    }\n  });\n};\n\n// Hook to cancel booking\n_s6(useUpdateBooking, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n  return [useQueryClient, useMutation];\n});\nexport const useCancelBooking = () => {\n  _s7();\n  const queryClient = useQueryClient();\n  return useMutation({\n    mutationFn: id => apiService.cancelBooking(id),\n    onSuccess: cancelledBooking => {\n      // Update the specific booking in cache\n      queryClient.setQueryData(queryKeys.booking(cancelledBooking.id), cancelledBooking);\n      // Invalidate slots query to refresh availability\n      queryClient.invalidateQueries({\n        queryKey: queryKeys.slots\n      });\n    },\n    onError: error => {\n      console.error('Failed to cancel booking:', error);\n    }\n  });\n};\n_s7(useCancelBooking, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n  return [useQueryClient, useMutation];\n});","map":{"version":3,"names":["useMutation","useQuery","useQueryClient","apiService","queryKeys","slots","bookings","booking","id","useAvailableSlots","date","providerId","limit","offset","_s","queryKey","queryFn","getAvailableSlots","staleTime","gcTime","refetchInterval","useBooking","_s2","getBooking","enabled","useProviders","_s3","getProviders","useAllSlotsForProviderAndDate","_s4","getAllSlotsForProviderAndDate","useCreateBooking","_s5","queryClient","mutationFn","bookingData","createBooking","onSuccess","invalidateQueries","onError","error","console","useUpdateBooking","_s6","status","updateBooking","updatedBooking","setQueryData","useCancelBooking","_s7","cancelBooking","cancelledBooking"],"sources":["/Users/yash/Desktop/urban booking/frontend/src/hooks/useBookings.ts"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { apiService } from '../services/api';\nimport { CreateBookingRequest, UpdateBookingRequest, BookingStatus } from '../types';\n\n// Query keys for React Query\nexport const queryKeys = {\n  slots: ['slots'] as const,\n  bookings: ['bookings'] as const,\n  booking: (id: string) => ['booking', id] as const,\n};\n\n// Hook to get available slots\nexport const useAvailableSlots = (date?: string, providerId?: string, limit: number = 6, offset: number = 0) => {\n  return useQuery({\n    queryKey: [...queryKeys.slots, date, providerId, limit, offset],\n    queryFn: () => apiService.getAvailableSlots({ date, providerId, limit, offset }),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n    refetchInterval: 3000, // Poll every 3 seconds for real-time updates\n  });\n};\n\n// Hook to get a specific booking\nexport const useBooking = (id: string) => {\n  return useQuery({\n    queryKey: queryKeys.booking(id),\n    queryFn: () => apiService.getBooking(id),\n    enabled: !!id,\n    staleTime: 2 * 60 * 1000, // 2 minutes\n  });\n};\n\n// Hook to get all providers\nexport const useProviders = () => {\n  return useQuery({\n    queryKey: ['providers'],\n    queryFn: () => apiService.getProviders(),\n    staleTime: 10 * 60 * 1000, // 10 minutes\n  });\n};\n\n// Hook to get all slots (including booked/unavailable) for a provider and date\nexport const useAllSlotsForProviderAndDate = (date: string, providerId: string, enabled: boolean) => {\n  return useQuery({\n    queryKey: ['all-slots', date, providerId],\n    queryFn: () => apiService.getAllSlotsForProviderAndDate(date, providerId),\n    enabled,\n    staleTime: 5 * 60 * 1000,\n    refetchInterval: 3000,\n  });\n};\n\n// Hook to create a booking\nexport const useCreateBooking = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (bookingData: CreateBookingRequest) => \n      apiService.createBooking(bookingData),\n    onSuccess: () => {\n      // Invalidate slots query to refresh available slots\n      queryClient.invalidateQueries({ queryKey: queryKeys.slots });\n    },\n    onError: (error: any) => {\n      console.error('Failed to create booking:', error);\n    },\n  });\n};\n\n// Hook to update booking status\nexport const useUpdateBooking = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, status }: { id: string; status: BookingStatus }) =>\n      apiService.updateBooking(id, { status }),\n    onSuccess: (updatedBooking) => {\n      // Update the specific booking in cache\n      queryClient.setQueryData(\n        queryKeys.booking(updatedBooking.id),\n        updatedBooking\n      );\n      // Invalidate slots query to refresh availability\n      queryClient.invalidateQueries({ queryKey: queryKeys.slots });\n    },\n    onError: (error: any) => {\n      console.error('Failed to update booking:', error);\n    },\n  });\n};\n\n// Hook to cancel booking\nexport const useCancelBooking = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => apiService.cancelBooking(id),\n    onSuccess: (cancelledBooking) => {\n      // Update the specific booking in cache\n      queryClient.setQueryData(\n        queryKeys.booking(cancelledBooking.id),\n        cancelledBooking\n      );\n      // Invalidate slots query to refresh availability\n      queryClient.invalidateQueries({ queryKey: queryKeys.slots });\n    },\n    onError: (error: any) => {\n      console.error('Failed to cancel booking:', error);\n    },\n  });\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}